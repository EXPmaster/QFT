<!doctype HTML>
<html>
  <head>
    <title>Downloading...</title>
    <meta charset="UTF-8">
    <script>
      function startDownload() {
        var queryMap = new Map(location.search.substr(1).split('&').map(function(a){return a.split('=')}));
        var downloadLink = document.getElementById('downloadLink');
        if (typeof queryMap.get('x') === 'undefined' || typeof queryMap.get('y') === 'undefined')
          downloadLink.href = `data:image/rle,x = ${queryMap.get('w')}, y = ${queryMap.get('h')}, rule = Varlife%0A` +
                                              queryMap.get('d');
        else
          downloadLink.href = `data:image/rle,%23CXRLE Pos=${queryMap.get('x')},${queryMap.get('y')}%0A` +
                                             `x = ${queryMap.get('w')}, y = ${queryMap.get('h')}, rule = Varlife%0A` +
                                              queryMap.get('d');
        downloadLink.click();
        history.back();
      }
    </script>
  </head>
  <body onload="startDownload()">
    <a id="downloadLink" download="download.rle">Download</a>
  </body>
</html>
